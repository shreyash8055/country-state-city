<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Select Location</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
    <h2>Select Your Location</h2>

    <label for="country">Country:</label>
    <select id="country">
        <option value="">Select Country</option>
    </select>

    <br><br>

    <label for="state">State:</label>
    <select id="state">
        <option value="">Select State</option>
    </select>

    <br><br>

    <label for="city">City:</label>
    <select id="city">
        <option value="">Select City</option>
    </select>

    <script>
        $(document).ready(function() {
            // Load countries
            $.get('/api/countries/', function(data) {
                data.countries.forEach(function(country) {
                    $('#country').append(`<option value="${country.id}">${country.name}</option>`);
                });
            });

            // When country changes, load states
            $('#country').change(function() {
                let country_id = $(this).val();
                $('#state').html('<option value="">Select State</option>');
                $('#city').html('<option value="">Select City</option>');

                if (country_id) {
                    $.get(`/api/states/?country_id=${country_id}`, function(data) {
                        data.states.forEach(function(state) {
                            $('#state').append(`<option value="${state.id}">${state.name}</option>`);
                        });
                    });
                }
            });

            // When state changes, load cities
            $('#state').change(function() {
                let state_id = $(this).val();
                $('#city').html('<option value="">Select City</option>');

                if (state_id) {
                    $.get(`/api/cities/?state_id=${state_id}`, function(data) {
                        data.cities.forEach(function(city) {
                            $('#city').append(`<option value="${city.id}">${city.name}</option>`);
                        });
                    });
                }
            });
        });
    </script>
</body>
</html>
